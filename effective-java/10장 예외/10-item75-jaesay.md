# 예외의 상세 메시지에 실패 관련 정보를 담으라

사후 분석을 위해 실패 순간의 상황을 정확히 포착해 예외의 상세 메시지에 담아야 한다.

- 실패 순간을 포착하려면 발생한 예외에 관여한 모든 매개 변수와 필드의 값을 실패 메시지에 담아야 한다.
    - e.g. IndexOutOfBoundsException의 상세 메시지는 범위의 최솟값, 최댓값, 그리고 그 범위를 벗어났다는 인덱스의 값을 담아야 한다.
- 관련 데이터를 모두 담아야 하지만 장황할 필요는 없다. 스텍 추적에는 예외가 발생한 파일 이름과 줄번호는 물론 스택에서 호출한 다른 메서드들의 파일 이름과 줄번호까지 정확히 기록되어 있는게 보통이다. 그러니 문서와 소스에서 얻을 수 있는 정보는 길게 늘어놔봐야 군더더기가 될 뿐이다.
- 예외 상세 메시지와 최종 사용자에게 보여줄 오류 메시지를 혼동해서는 안된다. 예외 메시지는 가독성보다는 담긴 내용이 훨씬 중요하다.
- 실패를 적절히 포착하려면 필요한 정보를 예외 생성자에서 모두 받아서 상세 메시지까지 미리 생성해놓는 방법도 괜찮다. 실패를 더 잘 포착하게 하고 고품질의 상세 메시지를 만들어내는 코드를 예외 클래스 안으로 모아 주는 효과도 있어, 클래스 사용자가 메시지를 만드는 작업을 중복하지 않아도 된다.
  ```java
  /**
  * IndexOutOfBoundsException을 생성한다.
  * @param lowerBound 인덱스의 최솟값
  * @param upperBound 인덱스의 최댓값 + 1
  * @param index 인덱스의 실젯값
    */
    public IndexOutOfBoundsException(int lowerBound, int upperBound, int index) {
    // 실패를 포착하는 상세 메시지를 생성한다.
    super(String.format("최솟값: %d, 최댓값: %d, 인덱스: %d", lowerBound, upperBound, index));
  
    // 프로그램에서 이용할 수 있도록 실패 정보를 저장해둔다.
    this.lowerBound = lowerBound;
    this.upperBound = upperBound;
    this.index = index;
    }
  ```
- 예외는 실패와 관련한 정보를 얻을 수 있는 접근자 메서드를 적절히 제공하는 것이 좋다. 포착한 실패 정보는 예외 상황을 복구하는 데 사용할 수 있으므로 접근자 메서드는 비검사 예외보다 검사예외에서 더 빛을 발한다. 하지만 저자는 ‘toString이 반환한 값에 포함된 정보를 얻어올 수 있는 API를 제공하자'라는 일반원칙(75쪽)을 따른다는 관점에서, 비검사 예외도 상세 정보의 접근자 메서드를 제공하라고 권한다.