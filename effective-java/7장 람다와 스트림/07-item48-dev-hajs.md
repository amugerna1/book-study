## 스트림 병렬화는 주의해서 적용하라

### 동시성 프로그래밍
* 자바는 처음 릴리스된 1996년부터 스레드, 동기화, wait/notify 를 지원했다.
* 이후 버전이 올라가면서 동시성과 관련된 수많은 패키지와 메소드가 추가되었다.
* 그럼에도 스트림 병렬화는 주의해서 사용해야 한다.
<br><br>

### 왜?
* 병렬의 비용을 예측하지 못한 상태에서 병렬을 하는 경우, 오히려 프로그램을 느리게 만들 수 있는 원인이 될 수 있기 때문
* Limit 과 같은 중간 연산을 사용하면, 환경이 아무리 좋더라도 병렬화로는 성능 개선을 기대할 수 없다.
  * (남은 코어도 작업을 하고 && Limit 은 결국 원소들을 다 계산하고 중간 처리를 하는 것이므로)
<br><br>

### 병렬화의 효과가 가장 좋은 자료구조
* ArrayList
* HashMap
* HashSet
* ConcurrentHashMap 의 인스턴거나 배열
* int 범위
* long 범위
-> 이 자료구조들의 공통점은 **"데이터를 원하는 크기로 정확하고 손쉽게 나울 수 있다"** 는 점이다.<br>
따라서 다수의 스레드에 분배하기에 좋다 = 병렬화의 효과가 가장 좋다
<br><br>

### 결론
* 스트림을 잘못 병렬화하면 성능이 나빠질 뿐만 아니라 결과 자체가 잘못되거나 예상치 못한 동작이 발생할 수 있다.
* 병렬화하는 편이 낫다고 믿더라도, **수정 후의 코드를 운영과 유사한 환경에 올려서 코드가 여전히 정확하고 성능이 좋아진게 확실해지면 그때 코드를 반영**하자.
* 그만큼 스트림 병렬화는 잘 사용하지 않는다.
